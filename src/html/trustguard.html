<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="pageTitle">TrustGuard Analysis | modcore Extension Manager</title>
    <meta name="description" data-i18n="pageDescription" content="Get a detailed TrustGuard analysis of your browser extensions, assessing their permissions and potential risks to your privacy and security.">
    <meta name="color-scheme" content="light dark">
    <link rel="stylesheet" href="../css/trustguard.css">
    <link rel="stylesheet" href="../../public/fonts/fonts.css">
</head>
<body>
    <div class="page-wrapper">
        <main class="main-content">

            <div id="all-extensions-view">
                <header class="page-header all-extensions-header">
                    <h1 class="extension-name">TrustGuard Dashboard</h1>
                    <h2 class="header-title">Overall Security & Privacy Overview</h2>
                </header>

                <section id="overview-section" class="content-section">
                    <div class="section-header">
                        <h2>Overall Risk Summary</h2>
                        <p class="section-description">A high-level summary of your installed extensions' security and privacy postures. Use this to quickly identify potential risks across your browser.</p>
                    </div>
                    <div class="overview-stats">
                        <div class="stat-card">
                            <h3 id="total-extensions-count" class="stat-count">--</h3>
                            <p>Total Extensions</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="enabled-extensions-count" class="stat-count">--</h3>
                            <p>Enabled Extensions</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="critical-risk-count" class="stat-count">--</h3>
                            <p>Critical Risk</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="high-risk-count" class="stat-count">--</h3>
                            <p>High Risk</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="moderate-risk-count" class="stat-count">--</h3>
                            <p>Moderate Risk</p>
                        </div>
                    </div>
                </section>

                <section class="content-section">
                    <div class="section-header">
                        <h2>Top Permissions by Count</h2>
                        <p class="section-description">Click a permission to view all extensions that use it.</p>
                    </div>
                    <ul id="permission-count-list" class="dashboard-list"></ul>
                </section>

                <section class="content-section">
                    <div class="section-header">
                        <h2>Extensions by Risk Rating</h2>
                        <p class="section-description">Click a risk category to view all extensions within that rating.</p>
                    </div>
                    <ul id="risk-rating-list" class="dashboard-list"></ul>
                </section>
                
                <section class="content-section">
                    <div class="section-header">
                        <h2>All Extensions</h2>
                        <p class="section-description">Search for extensions by name or view a detailed TrustGuard report by selecting one.</p>
                        <div class="search-container">
                            <input type="search" id="permission-search-input" placeholder="Search extensions by name, permission, or risk level...">
                        </div>
                    </div>
                    <ul id="all-extensions-list" class="all-extensions-list"></ul>
                </section>
            </div>

            <div id="single-extension-view" style="display: none;">
                <header class="page-header">
                    <button id="back-to-dashboard-btn" class="back-button">← Back to Dashboard</button>
                    <div class="extension-identity">
                        <img id="extension-icon" src="../../public/icons/svg/terminal.svg" alt="Extension Icon" class="extension-icon">
                        <h1 id="extension-name" class="extension-name">TrustGuard Analysis</h1>
                    </div>
                    <h2 class="header-title">Comprehensive Security & Privacy Report</h2>
                </header>

                <section class="content-section" aria-labelledby="trust-score-heading">
                    <div class="section-header">
                        <h2 id="trust-score-heading">Overall Trust Score</h2>
                        <p class="section-description">This score reflects the extension's potential risk based on its requested permissions. A higher score signifies greater trustworthiness and a lower-risk profile.</p>
                        <p class="section-note"><strong>Note:</strong> The scores are based on a heuristic model and should be considered as a guide only. They do not guarantee an extension's safety but highlight permissions that warrant closer review.</p>
                    </div>
                    <div class="score-cards-container">
                        <div class="score-card is-main">
                            <div id="trust-score-value" class="score-value">--</div>
                            <div id="trust-score-category" class="score-category risk-unknown">Analyzing...</div>
                            <p id="score-explanation" class="score-explanation">The assessment considers the quantity and severity of permissions, highlighting those that could compromise your data or browser integrity.</p>
                        </div>
                        <div class="score-card is-secondary">
                            <div class="secondary-score-header">
                                <h4 class="secondary-score-title">Security Score</h4>
                                <div class="score-graph-container">
                                    <div id="security-score-graph" class="score-graph">
                                        <div id="security-score-value" class="score-value">--</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="score-card is-secondary">
                            <div class="secondary-score-header">
                                <h4 class="secondary-score-title">Privacy Score</h4>
                                <div class="score-graph-container">
                                    <div id="privacy-score-graph" class="score-graph">
                                        <div id="privacy-score-value" class="score-value">--</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="content-section" aria-labelledby="what-if-heading">
                    <div class="section-header">
                        <h2 id="what-if-heading">"What If" Sandbox</h2>
                        <p class="section-description">Temporarily disable permissions below to see how the overall score would change. This helps you understand the impact of each permission on the extension's risk profile.</p>
                    </div>
                    <div class="what-if-sandbox-container">
                        <div class="what-if-score-card">
                            <div class="what-if-score-value" id="what-if-score-value">--</div>
                            <div class="what-if-score-category" id="what-if-score-category">Simulated Score</div>
                        </div>
                        <div id="what-if-sandbox"></div>
                    </div>
                </section>

                <section class="content-section" aria-labelledby="anomaly-heading">
                    <div class="section-header">
                        <h2 id="anomaly-heading">AI-Powered Anomaly Detection</h2>
                        <p class="section-description">This analysis uses a heuristic model to identify unusual permission requests that may not align with the extension's stated purpose, which could be a sign of hidden functionality or misuse.</p>
                    </div>
                    <div class="anomaly-report-container">
                        <div id="anomaly-report"></div>
                    </div>
                </section>

                <section class="content-section" aria-labelledby="least-privilege-heading">
                    <div class="section-header">
                        <h2 id="least-privilege-heading">Least Privilege Recommendations</h2>
                        <p class="section-description">This section suggests potential areas where the extension may be requesting more permissions than are necessary for its core function.</p>
                    </div>
                    <div class="least-privilege-container">
                        <div id="least-privilege-recommendations"></div>
                    </div>
                </section>

                <section class="content-section" aria-labelledby="synergy-heading">
                    <div class="section-header">
                        <h2 id="synergy-heading">Permission Synergy Heatmap</h2>
                        <p class="section-description">This table highlights dangerous combinations of permissions and their additional risk penalty. The more points, the greater the combined risk.</p>
                    </div>
                    <div id="permission-synergy-table" class="synergy-table"></div>
                </section>

                <section class="content-section" aria-labelledby="all-permissions-heading">
                    <div class="section-header">
                        <h2 id="all-permissions-heading">Categorized Permissions Report</h2>
                        <p class="section-description">A detailed breakdown of every permission this extension requests, grouped by risk level.</p>
                    </div>
                    <div class="detailed-report-container">
                        <div id="all-permissions-list" class="all-permissions-list-container"></div>
                    </div>
                </section>
            </div>

            <div id="filtered-extensions-view" style="display: none;">
                <header class="page-header all-extensions-header">
                    <button id="back-from-filtered-btn" class="back-button">← Back to Dashboard</button>
                    <h1 id="filtered-view-header" class="extension-name">Filtered Extensions</h1>
                    <h2 class="header-title">Extensions Matching Your Filter</h2>
                </header>
                <section class="content-section">
                    <ul id="filtered-extensions-list" class="all-extensions-list"></ul>
                </section>
            </div>

        </main>
    </div>

    <div id="toast-container" aria-live="polite" aria-atomic="true"></div>

    <script src="../js/trustguard.js"></script>
</body>
</html>
